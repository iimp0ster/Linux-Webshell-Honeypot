title: PHP Webshell Upload Detection
id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
status: experimental
description: Detects creation of PHP files in web directories that may indicate webshell upload
author: Tyler
date: 2025/11/02
logsource:
    product: linux
    service: auditd
detection:
    selection_path:
        type: 'PATH'
        name|contains:
            - '/var/www/'
            - '/usr/share/nginx/'
    selection_ext:
        name|endswith:
            - '.php'
            - '.phtml'
    selection_keywords:
        name|contains:
            - 'shell'
            - 'cmd'
            - 'eval'
    condition: selection_path and selection_ext and selection_keywords
falsepositives:
    - Legitimate application deployments
    - CMS installations
level: high
tags:
    - attack.initial_access
    - attack.t1190
    - attack.persistence
    - attack.t1505.003
